import{a as G,b as M,r as a,w as A,x as c,Q as d,j as e,H as O,G as b,y as v,z as B,T as F,A as P,D as R,E as $,J as U,c as z,K as Q,O as _,P as q,B as H,R as J}from"./index-e05NMAmt.js";const W=()=>{const i=G(),C=M();a.useEffect(()=>{i(A("Tournaments")),i(c(!0)),D()},[]);const[j,S]=a.useState([]),[f,T]=a.useState([]),[y,I]=a.useState([]),[N,n]=a.useState([]),[u,m]=a.useState([]),[l,g]=a.useState(""),[k,h]=a.useState(!1),x=s=>{let t=document.querySelectorAll(".conta .cate div");t.forEach(o=>o.classList.remove("active")),t[s].classList.add("active"),s===0?(n(f),m(f)):s===1?(n(j),m(j)):(n(y),m(y))},D=async()=>{try{const s=await fetch("/api/getalltournament",{method:"GET"}),t=await s.json();if(i(c(!1)),!s.ok)return d.warn(t.message,{autoClose:2e3});let o=[],p=[],w=[];t.data.forEach(r=>{r.status==="ongoing"&&o.push(r),r.status==="upcoming"&&p.push(r),r.status==="completed"&&w.push(r)}),S(o),T(p),I(w),n(p),m(p)}catch(s){console.log(s),i(c(!1))}},E=async()=>{if(l.trim()==="")return n(u),d.warn("Search is Empty",{autoClose:1200});if(l.trim().length!=8)return n(u),d.warn("Tournament Id must be 8 Digits",{autoClose:1200});try{i(c(!0));const s=await fetch("/api/tournamnetsearch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tournid:l})}),t=await s.json();if(console.log(t),i(c(!1)),!s.ok)return d.warn(t.message,{autoClose:1500});h(!0),n([t.query])}catch(s){i(c(!1)),console.log(s)}},L=s=>{C(`/tournaments/${s}`)};return e.jsxs("div",{className:"findtournas",children:[e.jsxs(O,{children:[e.jsx("title",{children:"Find Tournaments || BattleFiesta"}),e.jsx("link",{rel:"canonical",href:`${window.location.origin}/tournaments`}),e.jsx("meta",{name:"description",content:"Discover and join exciting PUBG, BGMI, and Free Fire tournaments on BattleFiesta. Browse ongoing and upcoming competitions, check rankings with automatic points tables, and compete with top players."})]}),e.jsxs("div",{className:"conta",children:[e.jsxs("div",{className:"cate",children:[e.jsxs("div",{onClick:()=>x(0),className:"active",children:[e.jsx(b,{}),e.jsx("span",{children:"UPCOMING"})]}),e.jsxs("div",{onClick:()=>x(1),children:[e.jsx(v,{}),e.jsx("span",{children:"ONGOING"})]}),e.jsxs("div",{onClick:()=>x(2),children:[e.jsx(B,{}),e.jsx("span",{children:"COMPLETED"})]})]}),e.jsxs("div",{children:[e.jsx(F,{label:"Tournament ID",fullWidth:!0,size:"small",type:"text",inputMode:"numeric",pattern:"[0-9]*",className:"filled",value:l,onChange:s=>{const t=s.target.value;if(t===""){g(""),n(u),h(!1);return}/^\d+$/.test(t)&&(t.length>8||(g(t),h(!0)))},inputProps:{maxLength:8},InputProps:{endAdornment:l?e.jsx(P,{className:"cross",position:"end",sx:{cursor:"pointer"},onClick:()=>{g(""),n(u),h(!1)},children:e.jsx(R,{})}):null}}),e.jsx($,{onClick:E,title:"Search",className:"searchIcon"})]})]}),e.jsxs("div",{className:"cards",children:[N.length<1&&e.jsx("div",{className:"notfound",children:e.jsxs("div",{children:[e.jsx(U,{className:"sad"}),e.jsx("h2",{children:"No Tournament Found"}),e.jsx("p",{children:"This section will be auto updated once any Tournament comes under this section"})]})}),N.map(s=>{const t=new Date(s.createdAt).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}),o=new Date(s.createdAt).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});return e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"img",children:[e.jsx("img",{loading:"lazy",src:z(s==null?void 0:s.tournment_logo,{format:"webp",width:300})||Q,alt:"logo"}),e.jsx("span",{title:s.title,children:s.title})]}),e.jsxs("h3",{className:"organiser",children:["- ",s.organiser]}),e.jsxs("div",{className:"time",children:[t,", ",o," ",e.jsx("span",{children:s.type})]}),e.jsxs("div",{className:"tournId",children:[e.jsxs("span",{children:[" ID :- ",s.tournid,e.jsx(_,{title:"Copy Id",onClick:()=>{navigator.clipboard.writeText(s.tournid),d.success("Copied",{autoClose:1e3})}})]}),e.jsxs("span",{title:`${s.totalTeamsRegistered} out of ${s.slots} slots Registered (including Approved and Pending teams)`,children:[" ",e.jsx(q,{})," ",s.totalTeamsRegistered," /",s.slots," "]})]}),e.jsxs("div",{className:"controller",children:[e.jsx(H,{size:"small",onClick:()=>L(s._id),variant:"contained",endIcon:e.jsx(J,{}),children:"READ MORE"}),k&&e.jsx("p",{className:"status",title:"Status",children:s.status})]})]},s._id)})]})]})};export{W as default};
