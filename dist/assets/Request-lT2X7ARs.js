import{b as u,a as z,j as e,w as D,T as c,F as _,I as F,S as I,M as w,B as k,e as T,Q as d,x as N,u as L,m as S,L as M,v as P,y as R}from"./index-CWnhsbVl.js";const A=({setinp:t,inp:a,membermodal:x,setmembermodal:o})=>{const[h,p]=u.useState({remarks:"",buydate:new Date,expiredate:new Date}),[y,m]=u.useState(!1),f=z();u.useEffect(()=>{},[a]);const j=(s,n)=>{p({...h,[n]:s.target.value}),t({...a,[n]:s.target.value})},g=async(s,n)=>{s.preventDefault();let r=h.remarks,b=a.status;const l=d.loading("Please wait...");try{m(!0);const i=localStorage.getItem("token"),v=await fetch("/api/createmembership",{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify({remarks:r,id:n,flag:b})}),C=await v.json();if(m(!1),v.ok)t(null),f(N()),d.update(l,{render:C.message,type:"success",isLoading:!1,autoClose:1700}),o(!1);else return d.update(l,{render:C.message,type:"warning",isLoading:!1,autoClose:2100})}catch(i){m(!1),d.update(l,{render:i.message,type:"warning",isLoading:!1,autoClose:2700}),console.log(i)}};return e.jsx(e.Fragment,{children:e.jsx(D,{open:x,onClose:()=>o(!1),children:e.jsx("div",{className:"membermodal",children:e.jsxs("form",{onSubmit:s=>g(s,a._id),children:[e.jsx("h2",{children:"Create Membership"}),e.jsxs("span",{className:"modalcontent",children:[e.jsxs("section",{children:[e.jsx(c,{value:a.plan_id.plan_name||"None",sx:{width:"48%"},label:"Plan",size:"small"}),e.jsx(c,{value:a.coupon||"None",sx:{width:"48%"},label:"Voucher",size:"small"})]}),e.jsxs("section",{children:[e.jsx(c,{value:a.discount||0,sx:{width:"48%"},label:"Discount",size:"small"}),e.jsx(c,{value:a.finalpricepaid,sx:{width:"48%"},label:"Final Price",size:"small"})]}),e.jsxs("section",{children:[e.jsx(c,{value:a.txn_no,sx:{width:"48%"},label:"Transaction No.",size:"small"}),e.jsxs(_,{sx:{width:"48%"},size:"small",children:[e.jsx(F,{id:"demo-simple-select-label",children:"Status"}),e.jsxs(I,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:a.status,label:"Status",onChange:s=>j(s,"status"),children:[e.jsx(w,{value:"pending",children:"Pending"}),e.jsx(w,{value:"success",children:"Success"}),e.jsx(w,{value:"rejected",children:"Rejected"})]})]})]}),e.jsx(c,{multiline:!0,rows:2,required:a.status=="rejected",onChange:s=>j(s,"remarks"),value:h.remarks,sx:{width:"100%"},label:"Remarks",size:"small"}),e.jsxs("div",{className:"btn",children:[e.jsx(k,{startIcon:e.jsx(T,{}),disabled:y,type:"submit",variant:"contained",children:" Submit"}),e.jsx(k,{onClick:()=>o(!1),variant:"outlined",children:" cancel"})]})]})]})})})})},E=()=>{var g;const t=L(s=>s.admin);u.useEffect(()=>{},[]);const a=z(),[x,o]=u.useState(null),[h,p]=u.useState(!1),y=s=>{p(!0),o(s)},m=async s=>{R({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Tournament!",icon:"warning",buttons:!0,dangerMode:!0}).then(async n=>{if(n)try{const r=d.loading("please wait..."),b=localStorage.getItem("token"),l=await fetch("/api/delmemberentry",{method:"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({ide:s})}),i=await l.json();l.ok&&(a(N()),d.update(r,{render:i.message,type:"success",isLoading:!1,autoClose:1600}))}catch(r){console.log(r)}})},f={hidden:{opacity:1,scale:0},visible:{opacity:1,scale:1,transition:{delayChildren:.3,staggerChildren:.2}}},j={hidden:{x:-80,y:80,opacity:0,scale:0},visible:{y:0,x:0,scale:1,opacity:1}};return e.jsx(e.Fragment,{children:e.jsxs(S.div,{className:"membershiprequest",children:[e.jsxs("div",{className:"controler",children:[e.jsx("h2",{style:{textAlign:"center"},children:"Membership Requests"}),e.jsx(M,{loading:t.loading,onClick:()=>a(N()),loadingPosition:"end",endIcon:e.jsx(P,{}),variant:"outlined",type:"submit",size:"small",className:"refreshe",children:"REFRESH"})]}),e.jsxs("div",{className:"header",children:[e.jsx("span",{children:"#"}),e.jsx("span",{children:"Name"}),e.jsx("span",{children:"Plan"}),e.jsx("span",{children:"Finalprice"}),e.jsx("span",{children:"Date"}),e.jsx("span",{children:"Txn. NO"}),e.jsx("span",{children:"Status"}),e.jsx("span",{children:"Actions"})]}),(t==null?void 0:t.membershipentry.length)<1&&e.jsx("div",{className:"body",children:"No Membership Request Found"}),e.jsx(S.div,{variants:f,initial:"hidden",animate:"visible",layout:!0,className:"body",children:(g=t==null?void 0:t.membershipentry)==null?void 0:g.map((s,n)=>{var i;const r={day:"2-digit",month:"short",year:"numeric"},l=new Date(s.createdAt).toLocaleDateString("en-GB",r);return e.jsxs(S.div,{variants:j,layout:!0,children:[e.jsx("span",{children:n+1}),e.jsx("span",{children:(i=s.user)==null?void 0:i.name}),e.jsx("span",{children:s.plan_id.plan_name}),e.jsx("span",{children:s.finalpricepaid}),e.jsx("span",{children:l}),e.jsx("span",{title:s.status=="success"?s.membershipId:"",children:s.txn_no}),e.jsx("span",{className:`status ${s.status}`,title:s.status=="rejected"?s.remarks:"",children:s.status}),e.jsxs("span",{children:[e.jsx("i",{className:"fa fa-pencil",onClick:()=>y(s),"aria-hidden":"true"}),e.jsx("i",{className:"fa fa-trash",onClick:()=>m(s._id),"aria-hidden":"true"})]})]},n)})}),x&&e.jsx(A,{setinp:o,inp:x,membermodal:h,setmembermodal:p})]})})};export{E as default};
