import{j as e,D as F,aq as re,ar as le,c as W,as as oe,at as me,T as y,a as de,s as ce,r as c,au as pe,v as ue,w as S,Q as o,H as he,B as g,av as ge,aw as xe,ax as je,an as ye,I as P,ay as fe,ab as _e,k as be,az as ke,aA as we,aB as Ne,aC as ve,n as Ie,aD as Ce,am as Le,aE as Se}from"./index-Cvqr62AC.js";import{G as Te}from"./index-CRYjVKid.js";import{_ as De}from"./index-DhHWQFoj.js";import{u as Re}from"./imageresizer-D4I-KFLq.js";import{D as T}from"./Divider-ttXbm9jC.js";import{B as Pe}from"./Box-JTBe4WlW.js";const Fe=({entry:x})=>{const w="https://res.cloudinary.com/dusxlxlvm/image/upload/v1718950086/battlefiesta/assets/icon/group2_gqiyup.webp",_="https://res.cloudinary.com/dusxlxlvm/image/upload/v1718950087/battlefiesta/assets/icon/user_p5egd9.webp";return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"teamse",children:[e.jsx("h2",{children:"Team List"}),x.length<1&&e.jsx("div",{className:"notfound",children:e.jsxs("div",{children:[e.jsx(F,{className:"sad"}),e.jsx("h1",{children:"Ops! This List is Empty"}),e.jsx("p",{children:"No Team Registered Yet"})]})}),x.map((d,D)=>e.jsxs(re,{style:{borderRadius:"6px",overflow:"hidden"},sx:{mb:1,minWidth:"95%"},children:[e.jsxs(le,{expandIcon:e.jsx(oe,{}),"aria-controls":"panel1-content",id:"panel1-header",className:`headere ${d.status}`,children:[e.jsx("img",{src:W(d==null?void 0:d.teamLogo,{format:"webp",width:100})||w,alt:"teamLogo"})," ",e.jsxs("span",{children:[d.teamName," "]})," ",e.jsxs("span",{className:d.status,children:[" ",d.status]})]}),e.jsx(me,{className:"detailse",children:e.jsxs("div",{className:"playerdata",children:[e.jsx("h2",{children:"Player List : "}),d.player.map((p,b)=>e.jsxs("div",{children:[e.jsx("span",{children:e.jsx("img",{src:W(p==null?void 0:p.playerLogo,{format:"webp",width:60})||_,alt:"playerLogo"})}),e.jsx("span",{title:"InGameName",children:p.inGameName}),e.jsx("span",{title:"InGameID",children:(p==null?void 0:p.inGameID)||"N/A"})]},b))]})}),d.status==="rejected"&&e.jsx(y,{id:"outlined-multiline-flexible",label:"Reason of Rejection",multiline:!0,color:"error",focused:!0,inputProps:{style:{fontSize:14}},value:d.reason||"your Fault",maxRows:6,sx:{minWidth:"96%",mb:1,ml:1,"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"red"},"&:hover fieldset":{borderColor:"red"},"&.Mui-focused fieldset":{borderColor:"red"}},"& .MuiInputLabel-root":{color:"red"},"& .MuiInputLabel-root.Mui-focused":{color:"red"}}})]},D))]})})},Ue=()=>{const x=de(),{handleImage:w}=Re(),_=ce("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),[d,D]=c.useState(!1),[p,b]=c.useState(!1),{registerId:G}=pe(),[H,N]=c.useState(!1);c.useEffect(()=>{x(ue("Registration")),x(S(!0)),q(G)},[]);const M={userid:"",tournament_id:"",teamname:"",teamemail:"",teammobile:"",teamdiscord:"",selectedTeamLogo:"",paymentss:"",players:Array(1).fill({inGameName:"",inGameID:"",playerLogo:""})},[r,u]=c.useState(M),V={tid:"",userid:"",title:"",organiser:"",status:"",tourna_banner:"",tourna_logo:"",id:"",isopen:"",description:"",success_msg:"",links:"",ask_email:"",ask_phone:"",ask_discord:"",ask_team_logo:"",ask_player_logo:"",ask_payment_ss:"",show_payment:"",amount:"",upi_id:"",slots:"",min_player:2,max_player:5},[n,Y]=c.useState(V),[$,K]=c.useState([]),[v,J]=c.useState([]),[A,Q]=c.useState(!1);function X(){const t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let a="";for(let i=0;i<18;i++){const s=Math.floor(Math.random()*t.length);a+=t.charAt(s)}return a}const q=async t=>{N(!0);try{const a=await fetch("/api/gettournamentform",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tid:t})}),i=await a.json();if(a.ok){N(!1);const s=i.data,l=i.data2;let m=i.enteries,j=m.filter(C=>C.status!="rejected");J(j),K(m),Y({...n,tid:s.tournament_id,userid:s.userid,id:s._id,isopen:s.isopen,description:s.description,success_msg:s.success_message,links:s.links,ask_email:s.ask_email,ask_phone:s.ask_phone,ask_discord:s.ask_discord,ask_team_logo:s.ask_teamlogo,ask_player_logo:s.ask_playerlogo,ask_payment_ss:s.ask_payment_ss,show_payment:s.show_payment,amount:s.amount,upi_id:s.upi_id,min_player:s.minimum_players,max_player:s.maximum_players,title:l.title,organiser:l.organiser,status:l.status,tourna_banner:l.tournment_banner,tourna_logo:l.tournment_logo,slots:l.slots,channel:l.userid.username}),u({...r,userid:s.userid,tournament_id:s.tournament_id,players:Array(s.minimum_players).fill({inGameName:"",inGameID:"",playerLogo:""})}),x(S(!1))}else Q(!0),x(S(!1))}catch(a){o.warn(a.message,{autoClose:2300}),x(S(!1))}},Z=async t=>{var l,m,j,C;if(t.preventDefault(),!((l=r.teamname)!=null&&l.trim()))return o.warn("Team Name is Required.",{autoClose:2300});if(!r.teamname||r.teamname.trim().length<3)return o.warn("Minimum 3 letters required for Team name",{autoClose:2300});if(n.ask_email&&!((m=r.teamemail)!=null&&m.trim()))return o.warn("Email is Required",{autoClose:2300});if(n.ask_phone&&!((j=r.teammobile)!=null&&j.trim()))return o.warn("Phone is Required",{autoClose:2300});if(n.ask_phone&&r.teammobile.trim().length!==10)return o.warn("Phone must be 10 digits",{autoClose:2300});if(n.ask_discord&&!((C=r.teamdiscord)!=null&&C.trim()))return o.warn("Discord is Required",{autoClose:2300});if(n.ask_team_logo&&!r.selectedTeamLogo)return o.warn("Select Team Logo",{autoClose:2300});if(n.ask_payment_ss&&!r.paymentss)return o.warn("Select Payment Screenshot",{autoClose:2300});let a=!1,i=!1;if(r.players.forEach(h=>{var k;(!((k=h.inGameName)!=null&&k.trim())||h.inGameName.trim().length<3)&&(a=!0),n.ask_player_logo&&!h.playerLogo&&(i=!0)}),a)return o.warn("Each player name must have at least 3 characters",{autoClose:2300});if(i)return o.warn("Select a logo for each player",{autoClose:2300});const s=new FormData;s.append("tid",r.tournament_id),s.append("userid",r.userid),s.append("teamName",r.teamname.trim()),s.append("email",r.teamemail.trim()),s.append("mobile",r.teammobile.trim()),s.append("discordID",r.teamdiscord.trim()),s.append("teamLogo",r.selectedTeamLogo),s.append("paymentScreenshot",r.paymentss);try{b(!0);const h=o.loading("Please wait...");N(!0);const k=await fetch("/api/Teamregister",{method:"POST",body:s}),B=await k.json(),ne=B.teamid;k.ok?(r.players.forEach(async(R,Ge)=>{let ie=X();const f=new FormData;f.append("teamid",ne),f.append("inGameName",R.inGameName),f.append("inGameID",R.inGameID),f.append("playerLogo",R.playerLogo),f.append("playerId",ie);try{const L=await fetch("/api/playerregister",{method:"POST",body:f}),Me=await L.json();L.ok}catch(L){o.error(L.message,{autoClose:1300})}}),o.update(h,{render:n.success_msg?n.success_msg:"Registered Successful",type:"success",isLoading:!1,autoClose:1600}),N(!1),u(M),q(G),D(!0)):o.update(h,{render:B.message,type:"warning",isLoading:!1,autoClose:1600}),b(!1)}catch(h){console.error(h),o.update(id,{render:h.message,type:"error",isLoading:!1,autoClose:1600}),b(!1)}},O=async(t,a)=>{let i=150;a=="paymentss"&&(i=680);let s=t.target.files[0],l=await w(i,s),m=document.createElement("img");const j=URL.createObjectURL(l);m.src=j,document.querySelector(`#${a}`).innerHTML="",document.querySelector(`#${a}`).appendChild(m),a=="teamlogo"&&u({...r,selectedTeamLogo:l}),a=="paymentss"&&u({...r,paymentss:l})},ee=async(t,a,i)=>{let s=t.target.files[0],l=await w(200,s),m=document.createElement("img");const j=URL.createObjectURL(l);m.src=j,document.querySelector(`#${a}`).innerHTML="",document.querySelector(`#${a}`).appendChild(m),ae(i,l)},I=t=>{let a=t.target.name,i=t.target.value;u({...r,[a]:i})},E=(t,a,i)=>{const{value:s}=t.target;u(l=>{const m=[...l.players];return m[a]={...m[a],[i]:s},{...l,players:m}})},ae=(t,a)=>{u(i=>{const s=[...i.players];return s[t]={...s[t],playerLogo:a},{...i,players:s}})},se=()=>{if(r.players.length<n.max_player){const a={inGameName:"",inGameID:"",playerLogo:""};u(i=>({...i,players:[...i.players,a]}))}else o.warn(`Max of ${n.max_player} Palyers are Allowed`,{autoClose:3100})},te=t=>{if(r.players.length>n.min_player){let i=r.players.filter((s,l)=>l!=t);u(s=>({...s,players:i}))}else o.warn(`Min of ${n.min_player} Palyers are Required`,{autoClose:3100})},[z,U]=c.useState(!1);return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"registartionform",children:[e.jsx(he,{children:e.jsx("title",{children:"Registration || BattleFiesta"})}),A&&e.jsx("div",{className:"notfound",children:e.jsxs("div",{children:[e.jsx(F,{className:"sad"}),e.jsx("h1",{children:"Ops! Something is Wrong"}),e.jsx("p",{children:"Registration form does not exits!"})]})}),!A&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"controler",children:[e.jsx(g,{onClick:()=>U(!1),startIcon:e.jsx(ge,{}),variant:"contained",color:"primary",children:"Registration Form"}),e.jsx(xe,{min:1,badgeContent:$.length,color:"success",children:e.jsx(g,{onClick:()=>U(!0),startIcon:e.jsx(je,{}),variant:"outlined",color:"secondary",children:"Team List"})})]}),!z&&e.jsxs("div",{className:"form",children:[e.jsxs("h2",{children:["Registration : ",n.title]}),e.jsxs("h4",{children:["Organised by : ",n.organiser,e.jsx(g,{variant:"outlined",startIcon:e.jsx(Te,{}),onClick:()=>window.open(`/channel/@${n.channel}`,"_blank"),children:" View Channel"})]}),e.jsxs("div",{className:"slots",children:[e.jsxs("span",{children:["Total Slots : ",n.slots]}),e.jsxs("span",{children:["Registered : ",v.length]}),e.jsxs("span",{children:["Available : ",n.slots-v.length]})]}),e.jsx(T,{variant:"middle"}),!d&&n.description!=""&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"desc",children:n.description.split(`
`).map((t,a)=>e.jsxs(ye.Fragment,{children:[t,e.jsx("br",{})]},a))}),e.jsx(T,{variant:"middle"})]}),!d&&n.isopen&&n.slots>v.length&&e.jsxs("form",{onSubmit:Z,children:[e.jsxs("div",{className:"compart",children:[e.jsx(y,{className:"cominp",size:"small",required:!0,id:"outlined-basic",label:"Team Name",inputProps:{minLength:3},value:r.teamname,name:"teamname",helperText:r.teamname.length<3?"Minimum length is 3 characters":"",onChange:I,variant:"outlined"}),n.ask_email&&e.jsx(y,{className:"cominp",type:"email",required:n.ask_email,value:r.teamemail,size:"small",id:"outlined-basic",name:"teamemail",label:"Email ID",onChange:I,variant:"outlined"}),n.ask_phone&&e.jsx(y,{className:"cominp",required:n.ask_phone,size:"small",id:"outlined-basic",name:"teammobile",value:r.teammobile,type:"tel",inputProps:{minLength:10,maxLength:10},onKeyPress:t=>{/[0-9]/.test(t.key)||t.preventDefault()},onChange:I,label:"Mobile",variant:"outlined",color:r.teammobile.length==10?"primary":"warning"}),n.ask_discord&&e.jsx(y,{inputProps:{minLength:15,maxLength:20},className:"cominp",required:n.ask_discord,size:"small",id:"outlined-basic",name:"teamdiscord",onChange:I,label:"Discord ID",variant:"outlined"})]}),e.jsx(T,{variant:"middle"}),n.ask_team_logo&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"Set a logo for the Team*"}),e.jsx("div",{id:"teamlogo"}),e.jsxs(g,{sx:{mb:3,mt:.5},component:"label",variant:"contained",startIcon:e.jsx(P,{}),children:["Upload Logo",e.jsx(_,{type:"file",accept:"image/*",onChange:t=>O(t,"teamlogo")})]}),e.jsx("br",{})]}),e.jsx(T,{variant:"middle"}),n.ask_payment_ss&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"Set Payment Screenshot*"}),e.jsx("div",{id:"paymentss"}),e.jsxs(g,{size:"small",sx:{mb:.5,mt:.5},component:"label",variant:"contained",startIcon:e.jsx(fe,{}),children:["Upload S.S",e.jsx(_,{type:"file",accept:"image/*",onChange:t=>O(t,"paymentss")})]}),e.jsx("p",{style:{color:"green",fontSize:"12px"},children:"*Note- UTR/Txn No. must be visible in Screenshot"}),e.jsx("br",{})]}),e.jsx("h3",{children:"Player List"}),r.players.map((t,a)=>e.jsxs("div",{className:"player",children:[e.jsxs("h4",{children:["Player ",a+1," ",e.jsx(_e,{className:"DeleteIcon",onClick:()=>te(a)})]}),e.jsxs(Pe,{sx:{"& > :not(style)":{m:1,width:"25ch"}},noValidate:!0,autoComplete:"off",children:[e.jsx(y,{size:"small",id:`in-game-name-${a}`,value:r.players[a].inGameName,onChange:i=>E(i,a,"inGameName"),label:"In Game Name*",inputProps:{minLength:3},variant:"outlined"}),e.jsx(y,{size:"small",id:`in-game-id-${a}`,value:r.players[a].inGameID,inputProps:{minLength:8,maxLength:13},type:"tel",onPaste:i=>{const s=i.clipboardData.getData("Text");/^[0-9]*$/.test(s)||i.preventDefault()},onKeyPress:i=>{/[0-9]/.test(i.key)||i.preventDefault()},onChange:i=>E(i,a,"inGameID"),label:"In Game ID",variant:"outlined"}),n.ask_player_logo&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"Set a logo for the player"}),e.jsx("div",{id:`playerLogo${a}`}),e.jsxs(g,{component:"label",variant:"contained",startIcon:e.jsx(P,{}),children:["Upload Logo",e.jsx(_,{type:"file",accept:"image/*",onChange:i=>ee(i,`playerLogo${a}`,a)})]})]})]})]},a)),e.jsx("div",{children:e.jsx(g,{title:"Add New Player",sx:{mb:2},onClick:se,startIcon:e.jsx(be,{}),disabled:H,variant:"outlined",color:"primary",children:"Add player"})}),e.jsx(g,{loading:p,loadingPosition:"start",startIcon:e.jsx(P,{}),variant:"contained",type:"submit",className:"registerbtn",children:"Register"})]}),!n.isopen&&e.jsxs("div",{className:"closed",children:[e.jsxs("div",{children:[" ",e.jsx(ke,{className:"stop"})]}),e.jsx("h1",{children:"REGISTRATION CLOSED"}),e.jsx("p",{children:"The Registration for this tournament has been closed by the Admin"})]}),n.slots<=v.length&&n.isopen&&e.jsxs("div",{className:"closed",children:[e.jsxs("div",{children:[" ",e.jsx(F,{className:"stop"})]}),e.jsx("h1",{children:"Oops! Slot is Full"}),e.jsx("p",{children:"The Registration for this tournament has been Full. It Excludes Teams Rejected"})]}),d&&e.jsxs("div",{className:"closed",children:[e.jsxs("div",{children:[" ",e.jsx(we,{className:"stop"})]}),e.jsx("h1",{children:"Registration Done ðŸ‘"}),e.jsx("p",{children:"You can now check your registration status on TeamList at any time, whether it is Pending, Approved, or Rejected"})]}),n.show_payment&&e.jsxs("div",{className:"showpayment",children:[e.jsx("div",{className:"img",children:e.jsx(De,{style:{height:"auto",maxWidth:"100%",width:"100%"},value:`upi://pay?pa=${n.upi_id}&am=${n.amount}&tn=battleFiesta&cu=INR`,viewBox:"0 0 256 256"})}),e.jsxs("div",{className:"remain",children:[e.jsx("div",{children:n.upi_id}),e.jsxs("div",{children:[e.jsx("b",{children:"Entry Fee:"})," â‚¹",n.amount]}),e.jsx(g,{sx:{mt:1},title:"PAY NOW",onClick:()=>{window.location.href=`upi://pay?pa=${n.upi_id}&am=${n.amount}&tn=battleFiesta&cu=INR`},startIcon:e.jsx(Ne,{}),variant:"outlined",color:"primary",children:"Pay Now"})]})]}),e.jsxs("div",{className:"contacts",children:[e.jsx("h2",{children:"Contact Details"}),n.links.length>0?e.jsx(e.Fragment,{children:e.jsx("div",{className:"links",children:n.links.map((t,a)=>{if(t.linkType=="whatsapp")return e.jsxs("a",{href:`https://wa.me/+91${t.link}`,target:"_blank",children:[e.jsx("span",{children:e.jsx(ve,{className:"ico"})})," ",e.jsx("span",{children:t.linkName})," "]},a);if(t.linkType=="instagram")return e.jsxs("a",{href:`https://www.instagram.com/${t.link}`,target:"_blank",children:[e.jsxs("span",{children:[" ",e.jsx(Ie,{className:"ico"})]}),e.jsx("span",{children:t.linkName})," "]},a);if(t.linkType=="phone")return e.jsxs("a",{href:`tel:${parseInt(t.link)}`,target:"_blank",children:[e.jsxs("span",{children:[" ",e.jsx(Ce,{className:"ico"})]}),e.jsxs("span",{children:[" ",t.linkName]})]},a);if(t.linkType=="email")return e.jsxs("a",{href:`mailto:${t.link}`,target:"_blank",children:[e.jsx("span",{children:e.jsx(Le,{className:"ico"})}),e.jsxs("span",{children:[" ",t.linkName]})]},a);if(t.linkType=="link")return e.jsxs("a",{href:t.link,target:"_blank",children:[e.jsx("span",{children:e.jsx(Se,{className:"ico"})}),e.jsx("span",{children:t.linkName})," "]},a)})})}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"The organiser has not provided any contact details for the tournament."}),e.jsx("p",{children:'If you are the organiser, check "Contact info" section in the tournament dashboard.'})]})]})]}),z&&e.jsx(Fe,{entry:$})," "]})]})})};export{Ue as default};
