import{r as d,a as N,j as e,aa as D,T as r,f as z,g as M,S as P,h as w,B as C,ag as R,Q as c,ah as S,u as T,m as F,a8 as I,a9 as _,ai as E,aj as L}from"./index-SBQvh4-N.js";import{R as O}from"./index-vrIUoG2M.js";import{X as A,u as B}from"./AllDbModal-5LchTK3-.js";import{d as q}from"./dayjs.min-yjHmKtCb.js";const $=({setinp:l,inp:t,membermodal:h,setmembermodal:i})=>{const[m,x]=d.useState({remarks:"",buydate:new Date,expiredate:new Date}),[g,u]=d.useState(!1),f=N();d.useEffect(()=>{},[t]);const s=(a,o)=>{x({...m,[o]:a.target.value}),l({...t,[o]:a.target.value})},n=async(a,o)=>{a.preventDefault();let p=m.remarks,b=t.status;const y=c.loading("Please wait...");try{u(!0);const j=localStorage.getItem("token"),v=await fetch("/api/createmembership",{method:"POST",headers:{Authorization:`Bearer ${j}`,"Content-Type":"application/json"},body:JSON.stringify({remarks:p,id:o,flag:b})}),k=await v.json();if(u(!1),v.ok)l(null),f(S()),c.update(y,{render:k.message,type:"success",isLoading:!1,autoClose:1700}),i(!1);else return c.update(y,{render:k.message,type:"warning",isLoading:!1,autoClose:2100})}catch(j){u(!1),c.update(y,{render:j.message,type:"warning",isLoading:!1,autoClose:2700}),console.log(j)}};return e.jsx(e.Fragment,{children:e.jsx(D,{open:h,onClose:()=>i(!1),children:e.jsx("div",{className:"membermodal",children:e.jsxs("form",{onSubmit:a=>n(a,t._id),children:[e.jsx("h2",{children:"Create Membership"}),e.jsxs("span",{className:"modalcontent",children:[e.jsxs("section",{children:[e.jsx(r,{value:t.plan_id.plan_name||"None",sx:{width:"48%"},label:"Plan",size:"small"}),e.jsx(r,{value:t.coupon||"None",sx:{width:"48%"},label:"Voucher",size:"small"})]}),e.jsxs("section",{children:[e.jsx(r,{value:t.discount||0,sx:{width:"48%"},label:"Discount",size:"small"}),e.jsx(r,{value:t.finalpricepaid,sx:{width:"48%"},label:"Final Price",size:"small"})]}),e.jsxs("section",{children:[e.jsx(r,{value:t.txn_no,sx:{width:"48%"},label:"Transaction No.",size:"small"}),e.jsxs(z,{sx:{width:"48%"},size:"small",children:[e.jsx(M,{id:"demo-simple-select-label",children:"Status"}),e.jsxs(P,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:t.status,label:"Status",onChange:a=>s(a,"status"),children:[e.jsx(w,{value:"pending",children:"Pending"}),e.jsx(w,{value:"success",children:"Success"}),e.jsx(w,{value:"rejected",children:"Rejected"})]})]})]}),e.jsx(r,{multiline:!0,rows:2,required:t.status=="rejected",onChange:a=>s(a,"remarks"),value:m.remarks,sx:{width:"100%"},label:"Remarks",size:"small"}),e.jsxs("div",{className:"btn",children:[e.jsx(C,{startIcon:e.jsx(R,{}),disabled:g,type:"submit",variant:"contained",children:" Submit"}),e.jsx(C,{onClick:()=>i(!1),variant:"outlined",children:" cancel"})]})]})]})})})})},Q=()=>{const l=T(s=>s.admin);d.useEffect(()=>{},[]);const t=N(),[h,i]=d.useState(null),[m,x]=d.useState(!1),g=s=>{x(!0),i(s)},u=async s=>{L({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Tournament!",icon:"warning",buttons:!0,dangerMode:!0}).then(async n=>{if(n)try{const a=c.loading("please wait..."),o=localStorage.getItem("token"),p=await fetch("/api/delmemberentry",{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({ide:s})}),b=await p.json();p.ok&&(t(S()),c.update(a,{render:b.message,type:"success",isLoading:!1,autoClose:1600}))}catch(a){console.log(a)}})},f=[{name:"#",selector:(s,n)=>n+1,width:"50px"},{name:"Name",cell:s=>{var n;return(n=s.user)==null?void 0:n.name}},{name:"Plan",selector:s=>s.plan_id.plan_name,width:"80px"},{name:"Final Price",selector:s=>s.finalpricepaid,width:"100px"},{name:"Date",selector:s=>q(s.createdAt).format("DD MMM, YYYY"),width:"100px"},{name:"Txn. NO",selector:s=>s.txn_no,width:"120px"},{name:"Status",selector:s=>e.jsx("span",{className:`status ${s.status}`,title:s.status=="rejected"?s.remarks:"",children:s.status}),width:"120px"},{name:"Action",selector:s=>e.jsxs("span",{children:[e.jsx(E,{className:"editicon ico",title:"Edit",onClick:()=>g(s)}),e.jsx(O,{className:"deleteicon ico",title:"Delete",onClick:()=>u(s._id)})]}),width:"120px"}];return e.jsx(e.Fragment,{children:e.jsxs(F.div,{className:"membershiprequest",children:[e.jsxs("div",{className:"controler",children:[e.jsx("h2",{style:{textAlign:"center"},children:"Membership Requests"}),e.jsx(I,{loading:l.loading,onClick:()=>t(S()),loadingPosition:"end",endIcon:e.jsx(_,{}),variant:"outlined",type:"submit",size:"small",className:"refreshe",children:"REFRESH"})]}),e.jsx(A,{columns:f,data:l==null?void 0:l.membershipentry,pagination:!0,highlightOnHover:!0,customStyles:B()}),h&&e.jsx($,{setinp:i,inp:h,membermodal:m,setmembermodal:x})]})})};export{Q as default};
