import{b as u,a as z,j as e,q as D,T as d,F as _,I as F,S as I,M as w,B as k,e as T,Q as h,t as S,u as L,m as v,L as M,v as P,w as R}from"./index-2w4dNxux.js";const q=({setinp:a,inp:t,membermodal:x,setmembermodal:r})=>{const[o,p]=u.useState({remarks:"",buydate:new Date,expiredate:new Date}),[y,m]=u.useState(!1),f=z();u.useEffect(()=>{},[t]);const j=(s,n)=>{p({...o,[n]:s.target.value}),a({...t,[n]:s.target.value})},g=async(s,n)=>{s.preventDefault();let l=o.remarks,b=o.status;try{m(!0);const i=h.loading("Please wait..."),c=localStorage.getItem("token"),N=await fetch("/api/createmembership",{method:"POST",headers:{Authorization:`Bearer ${c}`,"Content-Type":"application/json"},body:JSON.stringify({remarks:l,id:n,flag:b})}),C=await N.json();if(m(!1),N.ok)f(S()),h.update(i,{render:C.message,type:"success",isLoading:!1,autoClose:2100}),r(!1);else return h.update(i,{render:C.message,type:"warn",isLoading:!1,autoClose:2100})}catch(i){m(!1),h.update(toaste,{render:data.message,type:"warn",isLoading:!1,autoClose:5200}),console.log(i)}};return e.jsx(e.Fragment,{children:e.jsx(D,{open:x,onClose:()=>r(!1),children:e.jsx("div",{className:"membermodal",children:e.jsxs("form",{onSubmit:s=>g(s,t._id),children:[e.jsx("h2",{children:"Create Membership"}),e.jsxs("span",{className:"modalcontent",children:[e.jsxs("div",{style:{width:"100%"},children:[e.jsx(d,{value:t.plan_id.plan_name||"None",sx:{width:"45%"},label:"Plan",size:"small"}),e.jsx(d,{value:t.coupon||"None",sx:{width:"45%"},label:"Voucher",size:"small"})]}),e.jsxs("div",{style:{width:"100%"},children:[e.jsx(d,{value:t.discount||0,sx:{width:"45%"},label:"Discount",size:"small"}),e.jsx(d,{value:t.finalpricepaid,sx:{width:"45%"},label:"Final Price",size:"small"})]}),e.jsxs("div",{style:{width:"100%"},children:[e.jsx(d,{value:t.txn_no,sx:{width:"45%"},label:"Transaction No.",size:"small"}),e.jsxs(_,{sx:{width:"45%"},size:"small",children:[e.jsx(F,{id:"demo-simple-select-label",children:"Status"}),e.jsxs(I,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:t.status,label:"Status",onChange:s=>j(s,"status"),children:[e.jsx(w,{value:"pending",children:"Pending"}),e.jsx(w,{value:"success",children:"Success"}),e.jsx(w,{value:"rejected",children:"Rejected"})]})]})]}),e.jsx(d,{multiline:!0,rows:2,required:t.status=="rejected",onChange:s=>j(s,"remarks"),value:o.remarks,sx:{width:"95%"},label:"Remarks",size:"small"}),e.jsxs("div",{className:"btn",children:[e.jsx(k,{startIcon:e.jsx(T,{}),disabled:y,type:"submit",variant:"contained",children:" Submit"}),e.jsx(k,{onClick:()=>r(!1),variant:"outlined",children:" cancel"})]})]})]})})})})},B=()=>{var g;const a=L(s=>s.admin);u.useEffect(()=>{console.log(a.membershipentry)},[]);const t=z(),[x,r]=u.useState(null),[o,p]=u.useState(!1),y=s=>{p(!0),r(s)},m=async s=>{R({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Tournament!",icon:"warning",buttons:!0,dangerMode:!0}).then(async n=>{if(n)try{const l=h.loading("please wait..."),b=localStorage.getItem("token"),i=await fetch("/api/delmemberentry",{method:"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({ide:s})}),c=await i.json();i.ok&&(t(S()),h.update(l,{render:c.message,type:"success",isLoading:!1,autoClose:1600}))}catch(l){console.log(l)}})},f={hidden:{opacity:1,scale:0},visible:{opacity:1,scale:1,transition:{delayChildren:.3,staggerChildren:.2}}},j={hidden:{x:-80,y:80,opacity:0,scale:0},visible:{y:0,x:0,scale:1,opacity:1}};return e.jsx(e.Fragment,{children:e.jsxs(v.div,{className:"membershiprequest",children:[e.jsxs("div",{className:"controler",children:[e.jsx("h2",{style:{textAlign:"center"},children:"Membership Requests"}),e.jsx(M,{loading:a.loading,onClick:()=>t(S()),loadingPosition:"end",endIcon:e.jsx(P,{}),variant:"outlined",type:"submit",size:"small",className:"refreshe",children:"REFRESH"})]}),e.jsxs("div",{className:"header",children:[e.jsx("span",{children:"#"}),e.jsx("span",{children:"Name"}),e.jsx("span",{children:"Plan"}),e.jsx("span",{children:"Finalprice"}),e.jsx("span",{children:"Date"}),e.jsx("span",{children:"Txn. NO"}),e.jsx("span",{children:"Status"}),e.jsx("span",{children:"Actions"})]}),(a==null?void 0:a.membershipentry.length)<1&&e.jsx("div",{className:"body",children:"No Membership Request Found"}),e.jsx(v.div,{variants:f,initial:"hidden",animate:"visible",layout:!0,className:"body",children:(g=a==null?void 0:a.membershipentry)==null?void 0:g.map((s,n)=>{var c;const l={day:"2-digit",month:"short",year:"numeric"},i=new Date(s.createdAt).toLocaleDateString("en-GB",l);return e.jsxs(v.div,{variants:j,layout:!0,children:[e.jsx("span",{children:n+1}),e.jsx("span",{children:(c=s.user)==null?void 0:c.name}),e.jsx("span",{children:s.plan_id.plan_name}),e.jsx("span",{children:s.finalpricepaid}),e.jsx("span",{children:i}),e.jsx("span",{title:s.status=="success"?s.membershipId:"",children:s.txn_no}),e.jsx("span",{className:`status ${s.status}`,title:s.status=="rejected"?s.remarks:"",children:s.status}),e.jsxs("span",{children:[e.jsx("i",{className:"fa fa-pencil",onClick:()=>y(s),"aria-hidden":"true"}),e.jsx("i",{className:"fa fa-trash",onClick:()=>m(s._id),"aria-hidden":"true"})]})]},n)})}),x&&e.jsx(q,{setinp:r,inp:x,membermodal:o,setmembermodal:p})]})})};export{B as default};
