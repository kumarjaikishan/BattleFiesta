import{r as h,a as D,j as e,J as R,T as c,F as z,d as F,S as P,e as S,B as C,K as I,Q as d,O as v,u as T,m as w,E,H as L,P as M,R as _}from"./index-7ocn0Y_M.js";import{R as B}from"./index-mO08zUco.js";const O=({setinp:a,inp:t,membermodal:p,setmembermodal:o})=>{const[u,x]=h.useState({remarks:"",buydate:new Date,expiredate:new Date}),[y,m]=h.useState(!1),f=D();h.useEffect(()=>{},[t]);const j=(s,n)=>{x({...u,[n]:s.target.value}),a({...t,[n]:s.target.value})},g=async(s,n)=>{s.preventDefault();let r=u.remarks,b=t.status;const l=d.loading("Please wait...");try{m(!0);const i=localStorage.getItem("token"),N=await fetch("https://esport-backend.vercel.app/api/createmembership",{method:"POST",headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},body:JSON.stringify({remarks:r,id:n,flag:b})}),k=await N.json();if(m(!1),N.ok)a(null),f(v()),d.update(l,{render:k.message,type:"success",isLoading:!1,autoClose:1700}),o(!1);else return d.update(l,{render:k.message,type:"warning",isLoading:!1,autoClose:2100})}catch(i){m(!1),d.update(l,{render:i.message,type:"warning",isLoading:!1,autoClose:2700}),console.log(i)}};return e.jsx(e.Fragment,{children:e.jsx(R,{open:p,onClose:()=>o(!1),children:e.jsx("div",{className:"membermodal",children:e.jsxs("form",{onSubmit:s=>g(s,t._id),children:[e.jsx("h2",{children:"Create Membership"}),e.jsxs("span",{className:"modalcontent",children:[e.jsxs("section",{children:[e.jsx(c,{value:t.plan_id.plan_name||"None",sx:{width:"48%"},label:"Plan",size:"small"}),e.jsx(c,{value:t.coupon||"None",sx:{width:"48%"},label:"Voucher",size:"small"})]}),e.jsxs("section",{children:[e.jsx(c,{value:t.discount||0,sx:{width:"48%"},label:"Discount",size:"small"}),e.jsx(c,{value:t.finalpricepaid,sx:{width:"48%"},label:"Final Price",size:"small"})]}),e.jsxs("section",{children:[e.jsx(c,{value:t.txn_no,sx:{width:"48%"},label:"Transaction No.",size:"small"}),e.jsxs(z,{sx:{width:"48%"},size:"small",children:[e.jsx(F,{id:"demo-simple-select-label",children:"Status"}),e.jsxs(P,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:t.status,label:"Status",onChange:s=>j(s,"status"),children:[e.jsx(S,{value:"pending",children:"Pending"}),e.jsx(S,{value:"success",children:"Success"}),e.jsx(S,{value:"rejected",children:"Rejected"})]})]})]}),e.jsx(c,{multiline:!0,rows:2,required:t.status=="rejected",onChange:s=>j(s,"remarks"),value:u.remarks,sx:{width:"100%"},label:"Remarks",size:"small"}),e.jsxs("div",{className:"btn",children:[e.jsx(C,{startIcon:e.jsx(I,{}),disabled:y,type:"submit",variant:"contained",children:" Submit"}),e.jsx(C,{onClick:()=>o(!1),variant:"outlined",children:" cancel"})]})]})]})})})})},$=()=>{var g;const a=T(s=>s.admin);h.useEffect(()=>{},[]);const t=D(),[p,o]=h.useState(null),[u,x]=h.useState(!1),y=s=>{x(!0),o(s)},m=async s=>{_({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Tournament!",icon:"warning",buttons:!0,dangerMode:!0}).then(async n=>{if(n)try{const r=d.loading("please wait..."),b=localStorage.getItem("token"),l=await fetch("https://esport-backend.vercel.app/api/delmemberentry",{method:"POST",headers:{Authorization:`Bearer ${b}`,"Content-Type":"application/json"},body:JSON.stringify({ide:s})}),i=await l.json();l.ok&&(t(v()),d.update(r,{render:i.message,type:"success",isLoading:!1,autoClose:1600}))}catch(r){console.log(r)}})},f={hidden:{opacity:1,scale:0},visible:{opacity:1,scale:1,transition:{delayChildren:.3,staggerChildren:.2}}},j={hidden:{x:-80,y:80,opacity:0,scale:0},visible:{y:0,x:0,scale:1,opacity:1}};return e.jsx(e.Fragment,{children:e.jsxs(w.div,{className:"membershiprequest",children:[e.jsxs("div",{className:"controler",children:[e.jsx("h2",{style:{textAlign:"center"},children:"Membership Requests"}),e.jsx(E,{loading:a.loading,onClick:()=>t(v()),loadingPosition:"end",endIcon:e.jsx(L,{}),variant:"outlined",type:"submit",size:"small",className:"refreshe",children:"REFRESH"})]}),e.jsxs("div",{className:"header",children:[e.jsx("span",{children:"#"}),e.jsx("span",{children:"Name"}),e.jsx("span",{children:"Plan"}),e.jsx("span",{children:"Finalprice"}),e.jsx("span",{children:"Date"}),e.jsx("span",{children:"Txn. NO"}),e.jsx("span",{children:"Status"}),e.jsx("span",{children:"Actions"})]}),(a==null?void 0:a.membershipentry.length)<1&&e.jsx("div",{className:"body",children:"No Membership Request Found"}),e.jsx(w.div,{variants:f,initial:"hidden",animate:"visible",layout:!0,className:"body",children:(g=a==null?void 0:a.membershipentry)==null?void 0:g.map((s,n)=>{var i;const r={day:"2-digit",month:"short",year:"numeric"},l=new Date(s.createdAt).toLocaleDateString("en-GB",r);return e.jsxs(w.div,{variants:j,layout:!0,children:[e.jsx("span",{children:n+1}),e.jsx("span",{children:(i=s.user)==null?void 0:i.name}),e.jsx("span",{children:s.plan_id.plan_name}),e.jsx("span",{children:s.finalpricepaid}),e.jsx("span",{children:l}),e.jsx("span",{title:s.status=="success"?s.membershipId:"",children:s.txn_no}),e.jsx("span",{className:`status ${s.status}`,title:s.status=="rejected"?s.remarks:"",children:s.status}),e.jsxs("span",{children:[e.jsx(M,{className:"editicon ico",title:"Edit",onClick:()=>y(s)}),e.jsx(B,{className:"deleteicon ico",title:"Delete",onClick:()=>m(s._id)})]})]},n)})}),p&&e.jsx(O,{setinp:o,inp:p,membermodal:u,setmembermodal:x})]})})};export{$ as default};
