import{a as T,u as g,r as l,j as e,$ as I,X as A,U as O,T as y,f as $,g as z,S as B,h as C,B as m,V as S,a0 as p,Q as o}from"./index-dTATYgPo.js";import{R as E}from"./index-2nZWdBJa.js";const V=()=>{const d=T(),x=g(s=>s.admin);g(s=>s.tournacenter),l.useEffect(()=>{},[]);const b=async s=>{s.preventDefault();try{const t=localStorage.getItem("token"),a=await fetch("/api/createvoucher",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify(i)}),c=await a.json();a.status==200?(d(p()),n(!1),o.success(c.message,{autoClose:1300})):o.warn(c.message,{autoClose:1500})}catch(t){console.log(t)}},k=async s=>{swal({title:"Are you sure?",text:"Once deleted, you will not be able to recover this Tournament!",icon:"warning",buttons:!0,dangerMode:!0}).then(async t=>{if(t)try{const a=localStorage.getItem("token"),c=await fetch("/api/deletevoucher",{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({id:s})}),v=await c.json();c.ok?(d(p()),o.success(v.message,{autoClose:1300})):o.warn(v.message,{autoClose:1500})}catch(a){console.log(a)}})},w=async()=>{try{const s=localStorage.getItem("token"),t=await fetch("/api/editvoucher",{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(i)}),a=await t.json();t.ok?(n(!1),r(h),d(p()),o.success(a.message,{autoClose:1300})):o.warn(a.message,{autoClose:1500})}catch(s){console.log(s)}},N=s=>{f(!0),n(!0),r(t=>({name:s.coupon,percent:s.percent,isactive:s.isactive,id:s._id}))},[j,f]=l.useState(!1),[P,n]=l.useState(!1),u=(s,t)=>{r({...i,[t]:s.target.value})},h={name:"",percent:"",isactive:!0,id:""},[i,r]=l.useState(h);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"voucherpage",children:[e.jsx("div",{className:"conta",onClick:()=>{n(!0),f(!1)},title:"Add New Voucher",children:e.jsx(I,{})}),e.jsx("div",{className:"cards",children:x.voucher&&x.voucher.map((s,t)=>e.jsxs("div",{className:"card",children:[e.jsxs("div",{children:[e.jsx("span",{children:"Plan Name"})," ",e.jsx("span",{children:":"})," ",e.jsx("span",{children:s.coupon})]}),e.jsxs("div",{children:[e.jsx("span",{children:"Percent"})," ",e.jsx("span",{children:":"})," ",e.jsx("span",{children:s.percent})]}),e.jsxs("div",{children:[e.jsx("span",{children:"Status"})," ",e.jsx("span",{children:":"})," ",e.jsx("span",{children:s.isactive?"Active":"Expired"})]}),e.jsxs("div",{children:[e.jsx(A,{className:"editicon ico",title:"Edit",onClick:()=>N(s)}),e.jsx(E,{className:"deleteicon ico",title:"Delete",onClick:()=>k(s._id),style:{marginLeft:"20px"}})]})]},t))})]}),e.jsx(O,{open:P,onClose:()=>n(!1),children:e.jsx("div",{className:"membermodal",children:e.jsxs("form",{onSubmit:b,children:[e.jsx("h2",{children:"Create Voucher"}),e.jsxs("span",{className:"modalcontent",children:[e.jsx(y,{required:!0,value:i.name,onChange:s=>u(s,"name"),fullWidth:!0,label:"Plan Name",size:"small"}),e.jsx(y,{type:"tel",required:!0,value:i.percent,onChange:s=>u(s,"percent"),fullWidth:!0,label:"Percent",onKeyPress:s=>{/[0-9]/.test(s.key)||s.preventDefault()},size:"small"}),e.jsxs($,{fullWidth:!0,size:"small",children:[e.jsx(z,{id:"demo-simple-select-label",children:"Status"}),e.jsxs(B,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:i.isactive,label:"status",onChange:s=>u(s,"isactive"),children:[e.jsx(C,{value:!0,children:"Active"}),e.jsx(C,{value:!1,children:"Expired"})]})]}),e.jsxs("div",{style:{width:"100%"},children:[!j&&e.jsx(m,{startIcon:e.jsx(S,{}),type:"submit",variant:"contained",children:" Submit"}),j&&e.jsx(m,{startIcon:e.jsx(S,{}),onClick:w,variant:"contained",children:" Update"}),e.jsx(m,{onClick:()=>{n(!1),r(h)},variant:"outlined",children:" cancel"})]})]})]})})})]})};export{V as default};
